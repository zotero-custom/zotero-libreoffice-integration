<?xml version="1.0" ?>
<?xml-stylesheet href="chrome://global/skin/" type="text/css"?>
<?xml-stylesheet href="chrome://zotero/skin/zotero.css" type="text/css"?>
<?xml-stylesheet href="chrome://zotero-platform/content/zotero.css"?>
<?xml-stylesheet href="chrome://zotero/skin/upgrade.css" type="text/css"?>
<!DOCTYPE window SYSTEM "chrome://zotero/locale/zotero.dtd">

<window xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
	xmlns:html="http://www.w3.org/1999/xhtml"
	title="Zotero LibreOffice Plugin Installation" width="600"
	height="450" id="installer" onwizardcancel="return wizardCancelled();"
	onwizardback="wizardBack(); return false;">
	
	<script src="chrome://zotero/content/include.js"/>
	<script src="chrome://zotero/content/customElements.js"/>
	<script src="chrome://zotero/content/elements/richlistCheckbox.js"/>
	<script src="install.js"/>
	
<wizard>
	<linkset>
		<html:link rel="localization" href="toolkit/global/wizard.ftl"/>
	</linkset>
	
	<wizardpage pageid="intro" label="Introduction" next="libreoffice-installations">
		<description>
			The Zotero LibreOffice Plugin makes it easy to insert Zotero
			citations and bibliographies into LibreOffice documents.
		</description>
		<description>
			This wizard will install the plugin into LibreOffice. It can be reinstalled later from the
			Cite pane of the Zotero preferences.
		</description>
	</wizardpage>
	
	<wizardpage pageid="java-common" label="Install Required Components" next="java-common-install">
		<vbox id="java-common-progress" flex="1">
			<label>Searching for Required Components…</label>
			<progressmeter id="progress-indicator" mode="undetermined"/>
		</vbox>
		<vbox id="java-common-required" hidden="true" flex="1">
			<description>
				The Zotero LibreOffice Plugin requires the following packages:
			</description>
			<description id="java-common-packages" style="margin-left:0.5in"></description>
			<description>
				Press the “Next” button below to proceed with the installation.
			</description>
		</vbox>
	</wizardpage>
	
	<wizardpage pageid="java-common-install" label="Install Required Components" next="libreoffice-installations">
		<vbox id="java-common-install-progress" flex="1">
			<label>Installing required packages…</label>
			<progressmeter id="progress-indicator" mode="undetermined"/>
		</vbox>
		<description id="java-common-install-error" flex="1" hidden="true">
			An error occurred installing required packages. While you can attempt to
			install the Zotero LibreOffice Plugin anyway, it is unlikely to work.
			Click Cancel to abort the installation process.
		</description>
	</wizardpage>
	
	<wizardpage pageid="jre-required" label="Install Required Components" next="libreoffice-installations">
		<description>
			The Zotero LibreOffice Plugin requires the Java Development Kit. Visit
			<label class="zotero-text-link" is="zotero-text-link" href="https://www.oracle.com/java/technologies/downloads/">oracle.com</label>
			to download it.
		</description>
	</wizardpage>
	
	<wizardpage pageid="jdk-required" label="Install Required Components" next="libreoffice-installations">
		<description>
			The Zotero LibreOffice Plugin requires the Java Development Kit to work.
			Visit <label class="zotero-text-link" is="zotero-text-link" href="https://www.oracle.com/java/technologies/downloads/">oracle.com</label>
			to download it.
		</description>
	</wizardpage>
	
	<wizardpage pageid="libreoffice-installations" extra1="Add Directory…"
	extra2="Manual Installation" label="Select LibreOffice unopkg executable" next="installing">
		<description>
			Select LibreOffice installations from the list
			below, or click “Add Installation” to locate the path to an LibreOffice installation
			directory not shown in the list.
		</description>
		<description>
			To open the directory containing the LibreOffice extension file for manual installation
			from within LibreOffice, click “Manual Installation”.
		</description>
		<richlistbox height="150" id="installations-listbox" oncommand="libreofficeInstallationsListboxSelectionChanged()"/>
		<hbox pack="end">
			<button label="Manual Installation" oncommand="libreofficeInstallationsManualInstallation()"/>
			<button label="Add Directory…" oncommand="libreofficeInstallationsAddDirectory()"/>
		</hbox>
	</wizardpage>
	
	<wizardpage pageid="installing" label="Installing…" next="installation-complete">
		<vbox id="installation-progress" flex="1">
			<label>Installing the Zotero LibreOffice Plugin…</label>
			<progressmeter id="progress-indicator" mode="undetermined"/>
		</vbox>
	</wizardpage>
	
	<wizardpage pageid="installation-complete"
	label="Installation Complete">
		<description id="installation-successful">
			The Zotero LibreOffice Plugin was installed successfully.
			Depending on how LibreOffice is configured, it may be
			necessary to restart your computer for changes to take effect.
		</description>
		<vbox id="installation-error" hidden="true" flex="1">
			<description>
				Installation could not be completed because an error occurred.
			</description>
			<description>
				Would you like to view troubleshooting instructions?
			</description>
			<hbox pack="center">
				<button label="View Troubleshooting Instructions" onclick="viewTroubleshootingInstructions()"/>
			</hbox>
		</vbox>
	</wizardpage>
</wizard>
</window>
